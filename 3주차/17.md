<!-- @format -->

# 17ì¥. ìƒì„±ì í•¨ìˆ˜ - ê°ì²´ ìƒì„±

# 1. this ë°”ì¸ë”© ë¬¸ì œ

```js
function Circle(radius) {
  this.radius = radius;

  this.getDi = function () {
    console.log(this);
    return 2 * this.radius;
  };
}

Circle(10);

const c1 = new Circle(5);

const obj = {
  radius: 7,
  getDi: c1.getDi,
};

console.log(window.getDi());
console.log(c1.getDi());
console.log(obj.getDi());
```

<img src="https://velog.velcdn.com/images/ckx12/post/f5cc7f36-907e-4089-8f29-2fd38a0cd8cc/image.png"/>

---

| êµ¬ë¶„         | í˜¸ì¶œ ë°©ì‹            | `this`ê°€ ê°€ë¦¬í‚¤ëŠ” ê²ƒ      | ì˜ˆì‹œ ì½”ë“œ       | ê²°ê³¼ ì˜ˆì‹œ (`radius`) |
| ------------ | -------------------- | ------------------------- | --------------- | -------------------- |
| **ì¸ìŠ¤í„´ìŠ¤** | `new` í‚¤ì›Œë“œ ì‚¬ìš©    | ìƒˆë¡œ ìƒì„±ëœ ì¸ìŠ¤í„´ìŠ¤ ê°ì²´ | `new Circle(5)` | `5`                  |
| **ì „ì—­**     | í•¨ìˆ˜ ì§ì ‘ í˜¸ì¶œ       | ì „ì—­ ê°ì²´ (`window`)      | `Circle(10)`    | `10`                 |
| **ê°ì²´**     | ê°ì²´ì˜ ë©”ì„œë“œë¡œ í˜¸ì¶œ | í•´ë‹¹ ê°ì²´ (`obj`)         | `obj.getDi()`   | `7`                  |

---

| í˜¸ì¶œ ì½”ë“œ        | `this`ê°€ ê°€ë¦¬í‚¤ëŠ” ëŒ€ìƒ | `radius` ê°’ | ê²°ê³¼ |
| ---------------- | ---------------------- | ----------- | ---- |
| `window.getDi()` | `window` (ì „ì—­)        | 10          | 20   |
| `c1.getDi()`     | `c1` (ì¸ìŠ¤í„´ìŠ¤)        | 5           | 10   |
| `obj.getDi()`    | `obj` (ê°ì²´)           | 7           | 14   |

### 1ï¸âƒ£ `Circle(10);`

- `new` ì—†ì´ `Circle`ì„ í˜¸ì¶œ â†’ `this`ëŠ” **ì „ì—­ ê°ì²´**(`window` ë˜ëŠ” `globalThis`)ë¥¼ ê°€ë¦¬í‚´
- ê·¸ë˜ì„œ `window.radius = 10`ì´ ë˜ê³ 
- `window.getDi = function () { ... }` ë„ ìƒê¹€

---

### 2ï¸âƒ£ `const c1 = new Circle(5);`

- ìƒì„±ì í•¨ìˆ˜ì´ë¯€ë¡œ `this`ëŠ” ìƒˆë¡œ ë§Œë“¤ì–´ì§„ ì¸ìŠ¤í„´ìŠ¤ `c1`ì„ ê°€ë¦¬í‚´
- `c1.radius = 5`, `c1.getDi = function() { ... }`

---

### 3ï¸âƒ£ `const obj = { radius: 7, getDi: c1.getDi }`

- `c1.getDi` ë©”ì„œë“œë¥¼ `obj`ì— ë³µì‚¬
- `obj.getDi()`ë¥¼ í˜¸ì¶œí•˜ë©´ `this === obj` ê°€ ë¨

---

### âœ… ì‹¤í–‰ ë¶€ë¶„ ë¶„ì„

```js
console.log(window.getDi());
```

- í˜¸ì¶œ ì£¼ì²´: `window`
- `this === window`, `window.radius = 10` (ì•ì—ì„œ ì„¤ì •ë¨)
- ì¶œë ¥: `window` ê°ì²´ ì½˜ì†”ì— ì°í˜, `2 * 10 = 20`

```js
console.log(c1.getDi());
```

- í˜¸ì¶œ ì£¼ì²´: `c1` ì¸ìŠ¤í„´ìŠ¤
- `this === c1`, `c1.radius = 5`
- ì¶œë ¥: `c1` ê°ì²´ ì½˜ì†”ì— ì°í˜, `2 * 5 = 10`

```js
console.log(obj.getDi());
```

- í˜¸ì¶œ ì£¼ì²´: `obj`
- `this === obj`, `obj.radius = 7`
- ì¶œë ¥: `obj` ê°ì²´ ì½˜ì†”ì— ì°í˜, `2 * 7 = 14`

# 2. ìƒì„±ì í•¨ìˆ˜ì— ë¦¬í„´ë¬¸ì´ ìˆìœ¼ë©´ ìƒê¸°ëŠ” í˜„ìƒê³¼ ì—†ì–´ì•¼í•˜ëŠ” ì´ìœ 

## âœ… ìƒì„±ì í•¨ìˆ˜ì—ì„œ `return`ì˜ ë™ì‘ ì›ë¦¬

ìƒì„±ì í•¨ìˆ˜(`new`ì™€ í•¨ê»˜ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜) ë‚´ë¶€ì—ì„œ `return` ë¬¸ì„ ì“¸ ìˆ˜ëŠ” ìˆì§€ë§Œ, **ë¬´ì—‡ì„ ë°˜í™˜í•˜ëŠëƒì— ë”°ë¼ ë™ì‘ì´ ë‹¬ë¼ì§‘ë‹ˆë‹¤.**

### 1. **`ê°ì²´(object)`ë¥¼ ë°˜í™˜í•˜ë©´ â†’ ê·¸ ê°ì²´ê°€ ì¸ìŠ¤í„´ìŠ¤ê°€ ë¨**

```js
function Circle() {
  this.radius = 1;
  return { radius: 2 };
}

const c = new Circle();
console.log(c.radius);
//2
```

- `this`ë¡œ ì„¤ì •í•œ ê±´ **ë¬´ì‹œë˜ê³ **, `return { ... }` ì´ **ìµœì¢… ë°˜í™˜ê°’**ì´ ë¨

---

### 2. **`ê¸°ë³¸í˜•(primitive)`ì„ ë°˜í™˜í•˜ë©´ â†’ ë¬´ì‹œë¨**

```js
function Circle() {
  this.radius = 1;
  return 2;
  //  ë¬´ì‹œë¨
}

const c = new Circle();
console.log(c.radius);
// 1
```

- ìˆ«ì, ë¬¸ìì—´, ë¶ˆë¦°, `null`, `undefined` ê°™ì€ **ê¸°ë³¸í˜•**ì„ ë°˜í™˜í•˜ë©´ **`this`ê°€ ìë™ìœ¼ë¡œ ë°˜í™˜ë¨**

---

### 3. **`return`ì´ ì—†ìœ¼ë©´ â†’ `this`ê°€ ë°˜í™˜ë¨ (ê¸°ë³¸ ë™ì‘)**

```js
function Circle() {
  this.radius = 1;
  // return ì—†ìŒ
}

const c = new Circle();
console.log(c.radius);
//  1
```

---

## ğŸš« ìƒì„±ì í•¨ìˆ˜ì— `return`ì„ ë„£ìœ¼ë©´ ì•ˆ ë˜ëŠ” ì´ìœ 

| ì´ìœ                         | ì„¤ëª…                                                       |
| --------------------------- | ---------------------------------------------------------- |
| **í˜¼ë€ ìœ ë°œ**               | ìƒì„±ì í•¨ìˆ˜ì˜ `this`ê°€ ë¬´ì‹œë  ìˆ˜ ìˆìŒ â†’ ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥í•œ ê²°ê³¼ |
| **ìº¡ìŠí™” ìœ„ë°˜**             | ì™¸ë¶€ì—ì„œ ìƒì„±ì ë¡œì§ì„ ìš°íšŒí•  ìˆ˜ ìˆìŒ                      |
| **ì½”ë“œ ìŠ¤íƒ€ì¼ ì¼ê´€ì„± ê¹¨ì§** | ëŒ€ë¶€ë¶„ì˜ ìƒì„±ì í•¨ìˆ˜ëŠ” `return`ì„ ì“°ì§€ ì•ŠìŒ                |
| **ì´ˆë³´ìì—ê²Œ í˜¼ë€**         | ê°ì²´ê°€ ë°˜í™˜ë˜ëŠ”ì§€, ë¬´ì‹œë˜ëŠ”ì§€ íŒë‹¨í•˜ê¸° ì–´ë ¤ì›€              |

---

## âœ… ê²°ë¡ 

| ë°˜í™˜ ê°’ ìœ í˜• | ì‹¤ì œ ë°˜í™˜ ê°ì²´ |
| ------------ | -------------- |
| ê°ì²´         | `return ê°ì²´`  |
| ê¸°ë³¸í˜•       | `this`         |
| ìƒëµë¨       | `this`         |

> ë”°ë¼ì„œ **ìƒì„±ì í•¨ìˆ˜ì—ì„œëŠ” `return`ì„ ëª…ì‹œí•˜ì§€ ì•ŠëŠ” ê²ƒì´ ê°€ì¥ ì•ˆì „í•˜ê³  ì§ê´€ì **

# 3. ìƒì„±ì í•¨ìˆ˜ ì¤‘ ì¼ë¶€ëŸ¬ ë¦¬í„´ë¬¸ì„ ì“°ëŠ” ê²½ìš°ë„ ìˆì„ê¹Œ?

íŠ¹ë³„í•œ ëª©ì ì´ ìˆë‹¤ë©´ return ê°ì²´ ì‚¬ìš© ê°€ëŠ¥í•˜ì§€ë§Œ, ì¼ë°˜ì ì¸ ìƒì„±ì í•¨ìˆ˜ì—ì„œëŠ” í”¼í•˜ëŠ” ê²ƒì´ ì›ì¹™
ğŸ“Œ "ê°ì²´ ë¦¬í„´"ì„ ì“°ëŠ” ìˆœê°„, ìƒì„±ìì˜ ë³¸ì§ˆì¸ í”„ë¡œí† íƒ€ì… ê¸°ë°˜ ìƒì†ê°™ì€ê±°ëŠ” ë¬´ë ¥í™”ë˜ë²„ë¦¼

### íŒ©í† ë¦¬ íŒ¨í„´ì„ í‰ë‚´ë‚´ë ¤ëŠ” ê²½ìš°

```js
function User(name) {
  if (!(this instanceof User)) {
    return new User(name);
  }

  if (name === "admin") {
    return { name: "admin", role: "superuser" };
  }

  this.name = name;
}
```

```js
const user1 = new User("resident")
console.log(user1)
// [object Object]
{
  "name": "resident"
}


const user2 = new User("admin")
console.log(user2)
// [object Object]
{
  "name": "admin",
  "role": "superuser"
}

const user3 = User("bob")
console.log(user3)
// [object Object]
{
  "name": "bob"
}
```

### instanceof ?

- user3 ì—ì„œ
  ìƒì„±ì í•¨ìˆ˜ì¸ë° ì‚¬ìš©ìê°€ new ì—†ì´ í˜¸ì¶œí–ˆì„ ê²½ìš°, ë‚´ë¶€ì—ì„œ ê°•ì œë¡œ newë¥¼ ë¶™ì—¬ ì¬í˜¸ì¶œ

- `instanceof`ëŠ” thisê°€ ì–´ë–¤ ìƒì„±ì í•¨ìˆ˜ë¡œ ë§Œë“¤ì–´ì§„ì§€ í™•ì¸í•˜ëŠ” í‘œí˜„
  - A instanceof B : Aê°€ ìƒì„±ìí•¨ìˆ˜B ì˜ ì¸ìŠ¤í„´ìŠ¤ì¸ì§€ í™•ì¸
  - this instanceof User : thisê°€ ìƒì„±ìí•¨ìˆ˜ Userì˜ ì¸ìŠ¤í„´ìŠ¤ì¸ì§€ í™•ì¸
  => Userì˜ ì¸ìŠ¤í„´ìŠ¤ê°€ ì•„ë‹ˆë©´ ìƒì„±ìí•¨ìˆ˜ë¡œ í˜¸ì¶œí•˜ê²Œë” ì„¤ê³„
  => User()ì²˜ëŸ¼ new ì—†ì´ ìƒì„±ì í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ thisê°€ ì „ì—­ ê°ì²´ê°€ ë˜ëŠ” ë¬¸ì œë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ ì‘ì„±

# 4. ëª¨ë“  í•¨ìˆ˜ê°ì²´ëŠ” callbleì´ì—¬ì•¼í•˜ëŠ”ê°€?

í•¨ìˆ˜ëŠ” ê°ì²´ì´ë‹¤. ì¡°ê¸ˆ íŠ¹ë³„í•œ ê°ì²´
ì¦‰, ì¼ë°˜ ê°ì²´ê°€ ê°€ì§€ê³  ìˆëŠ” ë‚´ë¶€ìŠ¬ë¡¯ê³¼ ë‚´ë¶€ ë©”ì„œë“œë¥¼ ê°€ì§€ê³  ìˆë‹¤. ê±°ê¸°ì— ë”ë¶ˆì–´ í•¨ìˆ˜ë§Œì˜ íŠ¹ë³„í•œ `[[ENVIROMENT]]`, `[[CALL]]`, `[[CONSTRUCT]]` ë“±ì˜ ë‚´ë¶€ êµ¬ì¡°ë¥¼ ê°€ì§„ë‹¤

í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ `[[CALL]]` ë‚´ë¶€ ë©”ì„œë“œê°€ í˜¸ì¶œë˜ê³ 
ìƒì„±ìí•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ `[[CONSTRUCT]]` ë‚´ë¶€ ë©”ì„œë“œê°€ í˜¸ì¶œëœë‹¤.
=> ì¼ë°˜ê°ì²´ì™€ í•¨ìˆ˜ì˜ ê°€ì¥ í° ì°¨ì´ì ì€ `í˜¸ì¶œ` ì´ë‹¤

ì´ë¥¼ ì •ë¦¬í•˜ë©´,
í•¨ìˆ˜ëŠ” ì¼ë°˜ ê°ì²´ì™€ êµ¬ë³„ë˜ê¸° ìœ„í•œ ê°€ì¥ í° íŠ¹ì§•ìœ¼ë¡œ `í˜¸ì¶œ`ì˜ íŠ¹ì§•ì„ ê°€ì§€ë©°, ì´ëŠ” `ëª¨ë“  í•¨ìˆ˜ëŠ” callbleì´ë‹¤` ë¡œ ì—°ê²°ë  ìˆ˜ ìˆë‹¤

| í•­ëª©                                  | ì„¤ëª…                                       |
| ------------------------------------- | ------------------------------------------ |
| í•¨ìˆ˜ ê°ì²´ (`typeof x === 'function'`) | âœ… í•­ìƒ callable                           |
| ì¼ë°˜ ê°ì²´ (`typeof x === 'object'`)   | âŒ callable ì•„ë‹˜                           |
| í•¨ìˆ˜ì²˜ëŸ¼ ë³´ì´ì§€ë§Œ í˜¸ì¶œ ë¶ˆê°€í•œ ê²½ìš°    | í´ë˜ìŠ¤ ê°™ì€ íŠ¹ë³„í•œ í•¨ìˆ˜ëŠ” ì˜ˆì™¸ì  ì œí•œ ì¡´ì¬ |

# 5. ê·¸ëŸ¼ ëª¨ë“  í•¨ìˆ˜ê°ì²´ëŠ” constructor ì¸ê°€?

ì´ê²ƒì€ ì•„ë‹ˆë‹¤.
ëª¨ë“  í•¨ìˆ˜ê°€ í˜¸ì¶œì„ ê¸°ë³¸ ë² ì´ìŠ¤ë¡œ í•˜ê³  ìˆì§€ë§Œ,
ê·¸ë ‡ë‹¤ê³  í•´ì„œ ëª¨ë“  í•¨ìˆ˜ê°€ ìƒì„±ì í•¨ìˆ˜ë¡œ í˜¸ì¶œë˜ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤

ì´ë¥¼ êµ¬ë¶„ ì§“ëŠ” ê²ƒì€
ë°”ë¡œ `í•¨ìˆ˜ ì •ì˜ ë°©ì‹`ì´ë‹¤

| ì •ì˜ ë°©ì‹                                | constructor ê°€ëŠ¥?                    | ì„¤ëª…                           |
| ---------------------------------------- | ------------------------------------ | ------------------------------ |
| í•¨ìˆ˜ ì„ ì–¸ë¬¸ (`function A(){}`)           | âœ… ê°€ëŠ¥                              | ì¼ë°˜ì ì¸ ìƒì„±ì í•¨ìˆ˜           |
| í•¨ìˆ˜ í‘œí˜„ì‹ (`const A = function(){}`)   | âœ… ê°€ëŠ¥                              | ì´ ë°©ì‹ë„ ê°€ëŠ¥                 |
| **í™”ì‚´í‘œ í•¨ìˆ˜ (`const A = () => {}`)**   | âŒ ë¶ˆê°€                              | ìƒì„±ì í˜¸ì¶œ ë¶ˆê°€               |
| **ë©”ì„œë“œ ì¶•ì•½í˜• (`obj = { foo() {} }`)** | âŒ ë¶ˆê°€                              | ë©”ì„œë“œ ë¬¸ë²•ì€ constructor ì•„ë‹˜ |
| í´ë˜ìŠ¤ (`class A {}`)                    | âœ… ê°€ëŠ¥ (í•˜ì§€ë§Œ `new`ë¡œë§Œ í˜¸ì¶œ ê°€ëŠ¥) | í´ë˜ìŠ¤ëŠ” íŠ¹ë³„í•œ ìƒì„±ì í•¨ìˆ˜    |

# constructor ì—¬ë¶€ë¥¼ ë¬»ëŠ” ë¬¸ì œ

```js
const A = () => {};
function B() {}
const C = function () {};
const obj = {
  method() {},
};

// ì—ëŸ¬ê°€ ë‚˜ëŠ” ì½”ë“œëŠ”?
console.log(new A());
console.log(new B());
console.log(new C());
console.log(new obj.method());
```

ì •ë‹µì€ A,D
AëŠ” í™”ì‚´í‘œ í•¨ìˆ˜ â†’ constructor ì•„ë‹˜
DëŠ” ë©”ì„œë“œ ì¶•ì•½í˜• â†’ constructor ì•„ë‹˜

# ë¦¬í„´ë¬¸ ë¬¸ì œ

```js
function Person(name) {
  return name;
}

const p = new Person("A");

// ë­ê°€ ì¶œë ¥ë ê¹Œ
console.log(p);
```

ì •ë‹µì€ Person {}

1. this = {} ë¹ˆ ê°ì²´ ìƒì„±ë¨

2. Person í•¨ìˆ˜ ì‹¤í–‰ë¨ (thisëŠ” ìœ„ ë¹ˆ ê°ì²´)

3. returnì´ ëª…ì‹œë˜ì§€ ì•ŠìŒ â†’ this ë°˜í™˜

4. í•˜ì§€ë§Œ í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ this.name = name ê°™ì€ í• ë‹¹ë„ ì•ˆ í–ˆê¸° ë•Œë¬¸ì—â€¦
   â†’ thisëŠ” ì†ì„± ì—†ëŠ” ë¹ˆ ê°ì²´ì¸ Person {}ê°€ ë¨

5. ì œëŒ€ë¡œ ì¶œë ¥í•˜ë ¤ë©´ `this.name = name` ì¶”ê°€

---

âœ… ìƒì„±ì í•¨ìˆ˜ì—ì„œì˜ return ì²˜ë¦¬ ê·œì¹™

| `return` ê²°ê³¼ | ë°˜í™˜ ê°ì²´                  | ì„¤ëª…                        |
| ------------- | -------------------------- | --------------------------- |
| ì—†ìŒ (`ìƒëµ`) | ìë™ìœ¼ë¡œ `this` (ì¸ìŠ¤í„´ìŠ¤) | ì¼ë°˜ì ì¸ ìƒì„±ì í•¨ìˆ˜ì˜ ë™ì‘ |
| ê°ì²´ ë¦¬í„´     | ê·¸ **ê°ì²´ê°€ ìµœì¢… ê²°ê³¼**    | `this` ë¬´ì‹œë¨               |
| ì›ì‹œê°’ ë¦¬í„´   | ë¬´ì‹œë˜ê³  `this` ë°˜í™˜       | return 3, return "abc" ë“±   |
